set prompt "bashdots@.*> "
	# cd to script dir
set scriptDir [file normalize [file dirname [info script]]]
cd $scriptDir

	# Start bash

exp_spawn bash --rcfile bashrc
expect -re $prompt 
send "source ../../dots.bash\n"
expect -re $prompt 




set test "1up"
send "cd $scriptDir/fixture1\n"
expect -re $prompt 
	# Try completion
send ".. fixture\t"
expect {
	-re "fixture1/  fixture2/" { pass "$test" }
	-re $prompt                { fail "$test at prompt" }
	eof                        { fail "$test at eof" }
	timeout                    { fail "$test at timeout" }
}
expect -re "$prompt.. fixture"

set test "1upped"
	# Try to really cd
send "1\n"
expect {
	-re "fixture1"   { pass "$test" }
	-re $prompt      { fail "$test at prompt" }
	eof              { fail "$test at eof" }
	timeout          { fail "$test at timeout" }
}




set test "2up"
send "cd $scriptDir/fixture1/1.1\n"
expect -re $prompt
	# Try completion
send "... fixture1/1.\t"
expect {
	-re "fixture1/1.1/  fixture1/1.2/"   { pass "$test" }
	-re $prompt      { fail "$test prompt" }
	eof              { fail "$test at eof" }
	timeout          { fail "$test at timeout" }
}

send "\nexit\n"
